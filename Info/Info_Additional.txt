Андрей, добрый день!
Присылаю материал для тестирования.
Несколько пояснений (уточнений):
1. Данные формируются в один файл Export.bin (1\DynamicCtrlSoft\14_07_13_24_52). Формат заголовка файла - во вложенном файле (1\Заголовок файла.txt).
2. При выполнении теста, "на лету", происходит формирование файла Export.bin. После завершения испытания файл Export.bin закрывается и может использоваться. Никаких действий (и времени) для экспорта данных не требуется. 
3. Когда на закладке "Экспорт данных" не установлено ни одной "галочки" или когда параметр прореживания задан 0, Export.bin не создается.
4. Значение 0x7fffffff - признак неопределенных данных (например, значения температуры или дополнительного канала деформации или выключили ИРП...).
5. При желании, файл Export.bin можно "пересоздать" (например с другим параметром прореживания, или добавить пару параметров). Для этого открывается ранее сохраненное испытание и нажимается кнопка "Отчет" (принцип описан в первом моем письме).
Состав архива:
1. 1\DynamicCtrlSoft - папка из которой запускается исполняемый файл DynamicCtrlSoftV2.exe. В дальнейшем я Вам буду присылать только DynamicCtrlSoftV2.exe. Вы пока не обновляете DynamicCtrlSoftV2.exe на рабочем компьютере (я с ИРП еще позанимаюсь). Эта папка пока только для тестирования Export.bin на Вашем компьютере.
2. 1\DynamicCtrlSoft\14_07_13_24_52 - сохраненное испытание (симуляция) поддержания усилия 9876.5 Н в течении 123 сек. В этой папке так же имеется файл с экспортными данными (полный набор параметров, параметр прореживания 1000). Вы можете запустить DynamicCtrlSoftV2.exe, открыть испытание с закладки "Тест" (1\DynamicCtrlSoft\14_07_13_24_52\Info.bin), просмотреть параметры, пересоздать Export.bin с разным набором параметров и разным параметром прореживания.
Еще небольшое пояснение: при нажатии на кнопку "Отчет" (пере)создается Export.bin (если выбран хотя бы один параметр и параметр прореживания не 0) а затем создается протокол испытания Report.mht (предусмотрено открытие с помощью Word). Вас этот момент не интересует пока. Просто не обращайте внимания на этот момент.
Андрей, пока не начали реально пользоваться инструментом, не понятно что не предусмотрели. Готов к вопросам и замечаниям.
С уважением, Павел.


Частота сбора данных 5000 точек в секунду. Файл Points.bin - основной файл основных (3-х) параметров. Это самый большой файл, действительно, испытание длительностью 30 дней займет примерно 145 Гб. Не маленький файл, конечно. Кому то он будет нужен весь. Возможно и Вам захочется "перепроредить" или изучить более детально какой то участок (с полным набором точек). Тяжело ли обрабатывать такой файл? В Вашем случае обработки файла в принципе нет - происходит выборка данных с шагом прореживания. В любом случае этот файл создается, это концептуально для приложения DynamicCtrlSoft. Надеюсь, с этим определились.
В приложении DynamicCtrlSoft появляется закладка "Экспорт данных". Скрин - во вложенном файле. Параметры экспорта сохраняются при следующем открытии приложения. Покритикуйте.
Соответствующие поля заголовока файла:
...
int32_t Prescaler;                // Параметр прореживания.
struct _Format
    {
    int32_t IsTimeRecorded:1;        // 1 - Создавать метку времени (мс).
    int32_t IsForceRecorded:1;        // 1 - Создавать запись усилия в 0,1 Н.
    int32_t IsMovingRecorded:1;        // 1 - Создавать запись перемещения в 0,0001 мм.
    int32_t IsDeformationRecorded:1;    // 1 - Создавать запись деформации в 0,0001 мм.
    int32_t IsExtDeformationRecorded:1;    // 1 - Создавать запись деформации (доп. канал) в 0,0001 мм.
    int32_t IsVoltageRecorded:1;        // 1 - Создавать запись точек разности потенциала в 0,0001 мВ.
    int32_t IsTemperatureRecorded:1;    // 1 - Создавать запись точек разности потенциала в 0,0001 мВ.
    // Остальные 25 поля - резерв.
    } Format;

Андрей, добрый день. Несколько общих моментов "проговорю":
- Если не пользоваться кнопкой "Начать регистрацию данных", каждое новое испытание "пишется" в файлы расположенные в папке исполняемого файла DynamicCtrlSoftV2.exe. Т.о. эти файлы постоянно перезаписываются последними испытаниями. Если испытание требуется сохранить, необходимо перед запуском испытания нажать на кнопку "Начать регистрацию данных". Создается отдельная папка. Имя папки регистрации данных формируется автоматически и основано на системном времени компьютера в момент начала регистрации данных. Например, папка с именем  25_09_12_48_55 соответствует испытанию, регистрация которого началась 25 сентября в 12 часов, 48 минут, 55 секунд. Дирректория для создания таких папок выбирается в закладке «Настройки»->«Основные настройки»->«Дирректория сохранения испытаний». После завершения испытания, пользователь может нажать на кнопку "Отчет" для генерации протокола испытания. Так же можно открыть любое из ранее сохраненных испытаний, просмотреть его и по новой создать протокол испытания (нажав на кнопку "Отчет"). Протоколы испытаний Вас на данный момент не интересуют. Импорт данных испытания я вижу наиболее логичным реализовать именно по нажатию на кнопку "Отчет". Появляется диалог, позволяющий ввести строку комментария и параметр "прореживания" точек. В папке 25_09_12_48_55 появляется файл ImportPoints.bin. Комментарий может быть удобен при просмотре ImportPoints.bin любым редактором (по F3, например) чтобы в общих чертах понимать что в этом файле (например, "синус 46000Н, 10000 циклов"). Если по каким то причинам Вам захочется пересоздать файл ImportPoints.bin (например с другим шагом прореживания), можно открыть интересующее испытание и нажать на кнопку "Отчет".
- Основные импортируемые данные расположены в одном файле ImportPoints.bin (мне кажется одним файлом удобней). Первые 256 байт - строка комментария. Затем расположена структура параметров испытания размером 512+256 байт. Начиная с 1024 байта записываются точки испытания. Записываются только точки испытания. Участок до испытания и после окончания испытания не записывается. Если Вы считаете, что строка комментария не нужна, давайте откажемся. Размер 512+256 байт под структуру параметров испытания я предлагаю выделить с запасом под развитие (чтобы при расширении структуры, корректно открывались ранее сохраненные файлы ImportPoints.bin). 
- Я бы организовал работу так: я Вам присылаю файл ImportPoints.bin с пояснениями: «в этом файле данные испытания поддержания усилия 12345,6 Н на интервале 12345 секунд с прореживанием данных 1/25». Вы этот файл анализируете, выясняем неточности, что-то пересматриваем, возможно, и двигаемся дальше. Я Вам присылаю файл с другим испытанием... Гораздо хуже если проделать большую работу и Вас она при тестировании принципиально не устроит. И тестировать так легче будет.
- Интересует Ваше мнение по второму каналу деформации: сразу его заложим в точку данных или потом, когда «дело дойдет»? Можно отдельным файлом ImportDeformation2.bin, например. Приемственность версий сохранится. Я бы на этом варианте остановился.
- Похожий вопрос по точкам разницы потенциалов. Пока Ваш прибор не запустил, реально частоту опроса ИРП не представляю. Думаю не более 20 Гц (50 мс). Точкам разницы потенциалов в файле ImportPoints.bin то же "как то не место". С параметром прореживания тут все "путано" будет. Я бы точки разницы потенциала сохранял отдельным файлом ImportVoltage.bin. В этот файл пишется потенциал во время проведения испытания с фиксированным периодом (минимальным), например 50 мс. Такой подход довольно прост и легко "разруливается" (есть файл ImportVoltage.bin — есть точки разницы потенциала; нет файла — ИРП не использовался). Такой подход можно и в дальнейшем использовать. Например, спустя какое то время, Вы установите печь (ее подключение по RS-232 возможно к DynamicCtrlSoftV2.exe) и мы сможем договориться о импорте точек температуры в файл ImportTemperature.bin. При этом ничего концептуально не "ломается".
Сегодня я только вышел, день очень "комканый", завтра надеюсь мне дадут спокойно позаниматься. И жду вашего ответа. Андрей, любая критика приветствуется и принимается.
С уважением, Павел

